(function(){var t={6700:function(t,e,a){var n={"./af":2398,"./af.js":2398,"./ar":4207,"./ar-dz":3382,"./ar-dz.js":3382,"./ar-kw":6525,"./ar-kw.js":6525,"./ar-ly":7098,"./ar-ly.js":7098,"./ar-ma":6483,"./ar-ma.js":6483,"./ar-sa":3961,"./ar-sa.js":3961,"./ar-tn":7401,"./ar-tn.js":7401,"./ar.js":4207,"./az":903,"./az.js":903,"./be":1174,"./be.js":1174,"./bg":4615,"./bg.js":4615,"./bm":225,"./bm.js":225,"./bn":9751,"./bn-bd":544,"./bn-bd.js":544,"./bn.js":9751,"./bo":6894,"./bo.js":6894,"./br":8566,"./br.js":8566,"./bs":959,"./bs.js":959,"./ca":2683,"./ca.js":2683,"./cs":4231,"./cs.js":4231,"./cv":999,"./cv.js":999,"./cy":4302,"./cy.js":4302,"./da":3601,"./da.js":3601,"./de":5509,"./de-at":2479,"./de-at.js":2479,"./de-ch":5948,"./de-ch.js":5948,"./de.js":5509,"./dv":9838,"./dv.js":9838,"./el":5113,"./el.js":5113,"./en-au":7377,"./en-au.js":7377,"./en-ca":9626,"./en-ca.js":9626,"./en-gb":5912,"./en-gb.js":5912,"./en-ie":2931,"./en-ie.js":2931,"./en-il":2243,"./en-il.js":2243,"./en-in":9779,"./en-in.js":9779,"./en-nz":9813,"./en-nz.js":9813,"./en-sg":4318,"./en-sg.js":4318,"./eo":4957,"./eo.js":4957,"./es":9243,"./es-do":7409,"./es-do.js":7409,"./es-mx":5188,"./es-mx.js":5188,"./es-us":6927,"./es-us.js":6927,"./es.js":9243,"./et":7731,"./et.js":7731,"./eu":1072,"./eu.js":1072,"./fa":9462,"./fa.js":9462,"./fi":3368,"./fi.js":3368,"./fil":3626,"./fil.js":3626,"./fo":6421,"./fo.js":6421,"./fr":974,"./fr-ca":7780,"./fr-ca.js":7780,"./fr-ch":9719,"./fr-ch.js":9719,"./fr.js":974,"./fy":8373,"./fy.js":8373,"./ga":3861,"./ga.js":3861,"./gd":4896,"./gd.js":4896,"./gl":739,"./gl.js":739,"./gom-deva":6737,"./gom-deva.js":6737,"./gom-latn":1979,"./gom-latn.js":1979,"./gu":2001,"./gu.js":2001,"./he":9671,"./he.js":9671,"./hi":2038,"./hi.js":2038,"./hr":1228,"./hr.js":1228,"./hu":87,"./hu.js":87,"./hy-am":3569,"./hy-am.js":3569,"./id":1977,"./id.js":1977,"./is":6853,"./is.js":6853,"./it":7859,"./it-ch":5626,"./it-ch.js":5626,"./it.js":7859,"./ja":4123,"./ja.js":4123,"./jv":6457,"./jv.js":6457,"./ka":638,"./ka.js":638,"./kk":6823,"./kk.js":6823,"./km":9493,"./km.js":9493,"./kn":1288,"./kn.js":1288,"./ko":9663,"./ko.js":9663,"./ku":805,"./ku.js":805,"./ky":7550,"./ky.js":7550,"./lb":6272,"./lb.js":6272,"./lo":9135,"./lo.js":9135,"./lt":1452,"./lt.js":1452,"./lv":5782,"./lv.js":5782,"./me":2181,"./me.js":2181,"./mi":258,"./mi.js":258,"./mk":5715,"./mk.js":5715,"./ml":538,"./ml.js":538,"./mn":3086,"./mn.js":3086,"./mr":5663,"./mr.js":5663,"./ms":5100,"./ms-my":2663,"./ms-my.js":2663,"./ms.js":5100,"./mt":880,"./mt.js":880,"./my":9099,"./my.js":9099,"./nb":8709,"./nb.js":8709,"./ne":2201,"./ne.js":2201,"./nl":1016,"./nl-be":1681,"./nl-be.js":1681,"./nl.js":1016,"./nn":5330,"./nn.js":5330,"./oc-lnc":7132,"./oc-lnc.js":7132,"./pa-in":251,"./pa-in.js":251,"./pl":3948,"./pl.js":3948,"./pt":9836,"./pt-br":8831,"./pt-br.js":8831,"./pt.js":9836,"./ro":8443,"./ro.js":8443,"./ru":4,"./ru.js":4,"./sd":4510,"./sd.js":4510,"./se":3148,"./se.js":3148,"./si":542,"./si.js":542,"./sk":7637,"./sk.js":7637,"./sl":5852,"./sl.js":5852,"./sq":611,"./sq.js":611,"./sr":242,"./sr-cyrl":302,"./sr-cyrl.js":302,"./sr.js":242,"./ss":1367,"./ss.js":1367,"./sv":2927,"./sv.js":2927,"./sw":5240,"./sw.js":5240,"./ta":2692,"./ta.js":2692,"./te":2132,"./te.js":2132,"./tet":8300,"./tet.js":8300,"./tg":7211,"./tg.js":7211,"./th":4050,"./th.js":4050,"./tk":3849,"./tk.js":3849,"./tl-ph":3964,"./tl-ph.js":3964,"./tlh":3650,"./tlh.js":3650,"./tr":4195,"./tr.js":4195,"./tzl":5529,"./tzl.js":5529,"./tzm":7520,"./tzm-latn":298,"./tzm-latn.js":298,"./tzm.js":7520,"./ug-cn":4134,"./ug-cn.js":4134,"./uk":5456,"./uk.js":5456,"./ur":5679,"./ur.js":5679,"./uz":9277,"./uz-latn":6446,"./uz-latn.js":6446,"./uz.js":9277,"./vi":3992,"./vi.js":3992,"./x-pseudo":8882,"./x-pseudo.js":8882,"./yo":2899,"./yo.js":2899,"./zh-cn":4017,"./zh-cn.js":4017,"./zh-hk":4831,"./zh-hk.js":4831,"./zh-mo":2881,"./zh-mo.js":2881,"./zh-tw":57,"./zh-tw.js":57};function s(t){var e=o(t);return a(e)}function o(t){if(!a.o(n,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return n[t]}s.keys=function(){return Object.keys(n)},s.resolve=o,t.exports=s,s.id=6700},4158:function(t,e,a){"use strict";var n=a(8935),s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("keep-alive",[t.$route.meta.iskeep?a("router-view"):t._e()],1),t.$route.meta.iskeep?t._e():a("router-view")],1)},o=[],i={},r=i,l=a(1001),c=(0,l.Z)(r,s,o,!1,null,null,null),u=c.exports,h=(a(6888),a(8256)),d=a(2809),m=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("van-nav-bar",{attrs:{title:"登录"}}),a("van-form",{on:{submit:t.onSubmit}},[a("van-field",{attrs:{label:"手机号",placeholder:"请输入手机号",rules:t.rules.mobile},model:{value:t.info.mobile,callback:function(e){t.$set(t.info,"mobile",e)},expression:"info.mobile"}}),a("van-field",{attrs:{label:"验证码",placeholder:"请输入验证码",rules:t.rules.code},model:{value:t.info.code,callback:function(e){t.$set(t.info,"code",e)},expression:"info.code"}}),a("div",{staticStyle:{margin:"16px"}},[a("van-button",{attrs:{loading:t.isLoading,"loading-text":"加载中...",round:"",block:"",type:"info","native-type":"submit"}},[t._v("提交")])],1)],1)],1)},p=[],v=a(6166),f=a.n(v),g=a(4665);const y="token",_=()=>JSON.parse(localStorage.getItem(y)),b=t=>{localStorage.setItem(y,JSON.stringify(t))},k=()=>{localStorage.removeItem(y)};n.Z.use(g.ZP);var j=new g.ZP.Store({state:{tokenObj:_()||{},userinfo:{}},getters:{},mutations:{changeTokenObj(t,e){t.tokenObj=e,b(e)},changeUserinfo(t,e){t.userinfo=e},logout(t){k(),t.tokenObj={}}},actions:{async reqUserInfo(t){if(!t.state.userinfo.name){const e=await M();t.commit("changeUserinfo",e.data.data)}}},modules:{}});const w=f().create({baseURL:"http://geek.itheima.net/"});w.interceptors.request.use((t=>(t.headers.Authorization=`Bearer ${j.state.tokenObj.token}`,t)),(t=>Promise.reject(t))),w.interceptors.response.use((function(t){return t}),(async function(t){if(401===t.response.status)try{const e=await f()({url:"http://toutiao.itheima.net/v1_0/authorizations",method:"put",headers:{Authorization:"Bearer "+j.state.tokenObj.refresh_token}});return j.commit("changeTokenObj",{token:e.data.data.token,refresh_token:j.state.tokenObj.refresh_token}),w(t.config)}catch{h.Z.fail("登录状态失效请重新登录"),Ie.push("/login")}return Promise.reject(t)}));var x=w;const C=t=>x({method:"post",url:"/v1_0/authorizations",data:t}),Z=()=>x({url:"/v1_0/user/profile"}),$=t=>x({method:"PATCH",url:"/v1_0/user/profile",data:t}),S=t=>x({method:"PATCH",url:"/v1_0/user/photo",data:t}),O=()=>x({url:"/v1_0/user/channels"}),z=()=>x({url:"/v1_0/channels"}),L=t=>x({url:"/v1_0/user/channels",method:"put",data:t}),q=t=>x({url:"/v1_0/articles",params:t}),D=t=>x({url:`/v1_0/articles/${t}`}),E=t=>x({url:"/v1_0/comments",params:t}),H=t=>x({url:"/v1_0/comments",method:"POST",data:t}),T=t=>x({url:"/v1_0/suggestion",params:t}),N=t=>x({url:"/v1_0/search",params:t}),I=C,M=Z,U=$,P=S,V=O,A=z,R=L,F=q,B=D,J=E,Y=H,G=T,W=N;var K={name:"HmLogin",data(){return{isLoading:!1,info:{mobile:"13333333333",code:"246810"},rules:{mobile:[{required:!0,message:"请填写手机号"},{pattern:/^1[23456789]\d{9}$/,message:"请输入正确的手机号"}],code:[{required:!0,message:"请填写验证码"}]}}},methods:{async onSubmit(){this.isLoading=!0;try{const t=await I(this.info);this.$store.commit("changeTokenObj",t.data.data),this.$toast.success("登录成功"),this.$store.commit("changeUserinfo",{}),this.$route.query.back?this.$router.push(this.$route.query.back):this.$router.push("/layout/home")}catch{this.$toast.fali("登录失败")}this.isLoading=!1}}},Q=K,X=(0,l.Z)(Q,m,p,!1,null,null,null),tt=X.exports,et=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("router-view"),a("van-tabbar",{attrs:{route:""}},[a("van-tabbar-item",{attrs:{to:"/layout/home",icon:"home-o"}},[t._v("首页")]),a("van-tabbar-item",{attrs:{to:"/layout/ask",icon:"chat-o"}},[t._v("问答")]),a("van-tabbar-item",{attrs:{to:"/layout/video",icon:"video-o"}},[t._v("视频")]),a("van-tabbar-item",{attrs:{to:"/layout/mine",icon:"friends-o"}},[t._v("我的")])],1)],1)},at=[],nt={name:"LayoutIndex"},st=nt,ot=(0,l.Z)(st,et,at,!1,null,null,null),it=ot.exports,rt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("van-nav-bar",{scopedSlots:t._u([{key:"left",fn:function(){return[a("div",{staticClass:"logo"})]},proxy:!0},{key:"right",fn:function(){return[a("van-button",{attrs:{to:"/search",round:"",icon:"search",type:"primary"}},[t._v("搜索")])]},proxy:!0}])}),a("van-tabs",{model:{value:t.active,callback:function(e){t.active=e},expression:"active"}},[t._l(t.ownChannels,(function(t){return a("van-tab",{key:t.id,attrs:{title:t.name}},[a("articleList",{ref:"list",refInFor:!0,attrs:{channel_id:t.id}})],1)})),a("div",{staticClass:"icon-wrap",on:{click:function(e){t.channelshow=!0}}},[a("van-icon",{attrs:{name:"wap-nav"}})],1)],2),a("van-action-sheet",{attrs:{title:"频道管理"},model:{value:t.channelshow,callback:function(e){t.channelshow=e},expression:"channelshow"}},[a("ChannelManage",{attrs:{myChannels:t.ownChannels,allChannels:t.allChannels},on:{close:function(e){t.channelshow=!1},ChangeIndex:function(e){t.active--}},model:{value:t.active,callback:function(e){t.active=e},expression:"active"}})],1)],1)},lt=[],ct=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"list",staticClass:"articleList",on:{scroll:t.onscroll}},[a("van-pull-refresh",{on:{refresh:t.onRefresh},model:{value:t.isLoading,callback:function(e){t.isLoading=e},expression:"isLoading"}},[a("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了"},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,(function(e){return a("van-cell",{key:e.art_id,on:{click:function(a){return t.todetails(e.art_id)}}},[a("div",[t._v(t._s(e.title))]),[a("van-grid",{attrs:{border:!1,"column-num":e.cover.type}},t._l(e.cover.images,(function(t,e){return a("van-grid-item",{key:e},[a("van-image",{attrs:{src:t}})],1)})),1)],a("div",{staticClass:"bottominfo"},[a("span",[t._v(t._s(e.aut_name))]),a("span",[t._v(" "+t._s(e.comm_count)+"评论")]),a("span",[t._v(" "+t._s(t._f("dateFormat")(e.pubdate)))]),a("van-icon",{attrs:{name:"cross"}})],1)],2)})),1)],1)],1)},ut=[],ht={props:["channel_id"],data(){return{list:[],loading:!1,finished:!1,timestamp:Date.now(),isLoading:!1,scrolltop:0}},activated(){this.$refs.list.scrollTop=this.scrolltop},methods:{onscroll(){this.scrolltop=this.$refs.list.scrollTop},async onRefresh(){const t=await F({channel_id:this.channel_id,timestamp:Date.now()});this.list=t.data.data.results,this.isLoading=!1},async onLoad(){const t=await F({channel_id:this.channel_id,timestamp:this.timestamp});this.list.push(...t.data.data.results),this.timestamp=t.data.data.pre_timestamp,this.loading=!1,null==t.data.data.pre_timestamp&&(this.finished=!0)},todetails(t){this.$router.push({path:"/layout/home/articleDetails",query:{id:t}})}}},dt=ht,mt=(0,l.Z)(dt,ct,ut,!1,null,null,null),pt=mt.exports,vt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("div",[a("div",{staticClass:"mychannel"},[a("span",[t._v("我的频道")]),a("van-button",{attrs:{color:"red",size:"mini",plain:"",type:"primary"},on:{click:function(e){t.isShow=!t.isShow}}},[t._v("编辑")])],1),a("van-grid",t._l(t.myChannels,(function(e,n){return a("van-grid-item",{key:e.id,class:{active:n==t.value}},[a("span",{staticStyle:{"font-size":"14px"},on:{click:function(e){return t.activeChange(n)}}},[t._v(" "+t._s(e.name))]),a("van-icon",{directives:[{name:"show",rawName:"v-show",value:t.isShow&&"推荐"!=e.name,expression:"isShow && item.name != '推荐'"}],attrs:{name:"cross"},on:{click:function(e){return t.del(n)}}})],1)})),1)],1),a("div",{staticStyle:{"margin-top":"20px"}},[t._m(0),a("van-grid",t._l(t.optchannels,(function(e){return a("van-grid-item",{key:e.id,attrs:{text:e.name},on:{click:function(a){return t.add(e)}}})})),1)],1)])},ft=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"mychannel"},[a("span",[t._v("可选频道")])])}],gt={name:"channelHome",data(){return{isShow:!1}},props:{myChannels:{type:Array,required:!0},allChannels:{type:Array,required:!0},value:{type:Number,required:!0}},methods:{activeChange(t){this.$emit("input",t),this.$emit("close")},async save(){const t=this.myChannels.map(((t,e)=>({id:t.id,seq:e})));if(this.$store.state.tokenObj.token){const e=await R({channels:t});console.log("res:",e)}else window.localStorage.setItem("myChannels",JSON.stringify(this.myChannels))},add(t){this.myChannels.push(t),this.save()},del(t){this.myChannels.splice(t,1),this.save(),this.value>t&&this.$emit("ChangeIndex")}},computed:{optchannels(){return this.allChannels.filter((t=>!this.myChannels.find((e=>e.id===t.id))))}}},yt=gt,_t=(0,l.Z)(yt,vt,ft,!1,null,"65961ba4",null),bt=_t.exports,kt={name:"HmHome",components:{articleList:pt,ChannelManage:bt},data(){return{ownChannels:[],channelshow:!1,allChannels:[],active:0}},async created(){const t=JSON.parse(localStorage.getItem("myChannels"));if(this.$store.state.tokenObj.token||!t){const t=await V();this.ownChannels=t.data.data.channels}else this.ownChannels=t;const e=await A();this.allChannels=e.data.data.channels}},jt=kt,wt=(0,l.Z)(jt,rt,lt,!1,null,"46f53847",null),xt=wt.exports,Ct=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t._v(" ask ")])},Zt=[],$t={name:"HmAsk"},St=$t,Ot=(0,l.Z)(St,Ct,Zt,!1,null,null,null),zt=Ot.exports,Lt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t._v(" View ")])},qt=[],Dt={name:"HmView"},Et=Dt,Ht=(0,l.Z)(Et,Lt,qt,!1,null,null,null),Tt=Ht.exports,Nt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"profile-box"},[a("van-image",{attrs:{round:"",fit:"cover",src:t.userinfo.photo}}),a("div",{staticClass:"info-box"},[a("div",{staticClass:"name"},[t._v(t._s(t.userinfo.name))]),a("div",{staticClass:"birth"},[t._v(t._s(t.userinfo.birthday))])])],1),a("van-row",[a("van-col",{attrs:{span:"8"}},[a("van-icon",{staticClass:"skyblue",attrs:{name:"newspaper-o"}}),a("span",[t._v("我的作品")])],1),a("van-col",{attrs:{span:"8"}},[a("van-icon",{staticClass:"red",attrs:{name:"star-o"}}),a("span",[t._v("我的收藏")])],1),a("van-col",{attrs:{span:"8"}},[a("van-icon",{staticClass:"yello",attrs:{name:"tosend"}}),a("span",[t._v("阅读历史")])],1)],1),a("van-cell-group",[a("van-cell",{attrs:{to:"/layout/mine/edit",icon:"edit",title:"编辑资料","is-link":""}}),a("van-cell",{attrs:{to:"/layout/mine/chat",icon:"chat-o",title:"小智同学","is-link":""}}),a("van-cell",{attrs:{icon:"setting-o",title:"系统设置","is-link":""}}),a("van-cell",{attrs:{icon:"info-o",title:"退出登录","is-link":""},on:{click:t.logout}})],1)],1)},It=[],Mt={name:"HmMine",data(){return{}},computed:{...(0,g.rn)(["userinfo"])},created(){this.$store.dispatch("reqUserInfo")},methods:{logout(){this.$store.commit("logout"),this.$router.push("/login")}}},Ut=Mt,Pt=(0,l.Z)(Ut,Nt,It,!1,null,null,null),Vt=Pt.exports,At=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("van-nav-bar",{attrs:{"left-arrow":"",title:"编辑资料"},on:{"click-left":function(e){return t.$router.back()}}}),a("div",{staticClass:"uploader-box"},[a("van-image",{attrs:{round:"",fit:"cover",src:t.userinfo.photo}}),a("van-uploader",{attrs:{"after-read":t.afterRead}})],1),a("van-cell-group",[a("van-cell",{attrs:{title:"名称",value:t.userinfo.name,"is-link":""},on:{click:t.changeName}}),a("van-cell",{attrs:{title:"性别",value:t.userinfo.gender?"男":"女","is-link":""},on:{click:function(e){t.genderShow=!0}}}),a("van-cell",{attrs:{title:"生日",value:t.userinfo.birthday,"is-link":""},on:{click:t.showBirth}})],1),a("van-dialog",{attrs:{title:"修改名字","show-cancel-button":""},on:{confirm:t.updataName},model:{value:t.nameShow,callback:function(e){t.nameShow=e},expression:"nameShow"}},[a("van-field",{ref:"nameInp",staticClass:"nameInput",model:{value:t.nameValue,callback:function(e){t.nameValue="string"===typeof e?e.trim():e},expression:"nameValue"}})],1),a("van-popup",{attrs:{position:"bottom"},model:{value:t.genderShow,callback:function(e){t.genderShow=e},expression:"genderShow"}},[a("van-nav-bar",{attrs:{title:"修改性别","left-text":"取消"},on:{"click-left":t.hiddengenderShow}}),a("van-cell",{attrs:{title:"男","is-link":""},on:{click:function(e){return t.updataGender(1)}}}),a("van-cell",{attrs:{title:"女","is-link":""},on:{click:function(e){return t.updataGender(0)}}})],1),a("van-popup",{style:{height:"30%"},attrs:{position:"bottom"},model:{value:t.birthdayShow,callback:function(e){t.birthdayShow=e},expression:"birthdayShow"}},[a("van-datetime-picker",{attrs:{type:"date",title:"选择年月日","min-date":t.minDate,"max-date":t.maxDate},on:{confirm:t.updateBirthday,cancel:function(e){t.birthdayShow=!1}},model:{value:t.currentDate,callback:function(e){t.currentDate=e},expression:"currentDate"}})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:t.cropShow,expression:"cropShow"}],staticClass:"crop-box"},[a("vueCropper",{ref:"cropper",attrs:{img:t.img,autoCrop:"",autoCropWidth:"200",autoCropHeight:"200"}}),a("van-button",{attrs:{type:"primary"},on:{click:t.doCrop}},[t._v("裁剪")]),a("van-button",{staticStyle:{right:"0"},attrs:{type:"primary"},on:{click:function(e){t.cropShow=!1}}},[t._v("取消")])],1)],1)},Rt=[],Ft=a(7133),Bt=a.n(Ft),Jt=a(7086),Yt={name:"MineEdit",components:{VueCropper:Jt.VueCropper},data(){return{nameShow:!1,nameValue:"",birthdayShow:!1,minDate:new Date(1900,0,1),maxDate:new Date,currentDate:new Date(2021,0,17),genderShow:!1,img:"",cropShow:!1}},methods:{changeName(){this.nameShow=!0,this.nameValue=this.userinfo.name,setTimeout((()=>{this.$refs.nameInp.focus()}),1e3)},async updataName(){if(""===this.nameValue)return this.$toast("请输入名字");await U({name:this.nameValue}),this.$store.commit("changeUserinfo",{...this.userinfo,name:this.nameValue})},showBirth(){this.birthdayShow=!0,this.currentDate=new Date(this.userinfo.birthday)},async updateBirthday(){const t=Bt()(this.currentDate).format("YYYY-MM-DD");await U({birthday:t}),this.$store.commit("changeUserinfo",{...this.userinfo,birthday:t}),this.birthdayShow=!1},hiddengenderShow(){this.genderShow=!1},async updataGender(t){await U({gender:t}),this.$store.commit("changeUserinfo",{...this.userinfo,gender:t}),this.genderShow=!1},afterRead(t){this.cropShow=!0,this.img=t.content},doCrop(){this.$refs.cropper.getCropBlob((async t=>{const e=new FormData;e.append("photo",t);const a=await P(e);this.$store.commit("changeUserinfo",{...this.userinfo,photo:a.data.data.photo}),this.cropShow=!1}))}},computed:{...(0,g.rn)(["userinfo"])},created(){this.$store.dispatch("reqUserInfo")}},Gt=Yt,Wt=(0,l.Z)(Gt,At,Rt,!1,null,"7e6e9987",null),Kt=Wt.exports,Qt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("van-nav-bar",{attrs:{title:"文章详情","left-arrow":""},on:{"click-left":function(e){return t.$router.back()}}}),a("div",{staticClass:"root"},[a("h2",{staticClass:"title"},[t._v(t._s(t.newsDetail.title))]),a("div",{staticClass:"info"},[a("van-image",{attrs:{fit:"cover",round:"",src:t.newsDetail.aut_photo}}),a("span",{staticClass:"nametime"},[a("span",{staticClass:"name"},[t._v(t._s(t.newsDetail.aut_name))]),a("span",{staticClass:"time"},[t._v(t._s(t._f("dateFormat")(t.newsDetail.pubdate)))])]),a("van-button",{attrs:{round:"",icon:"plus",type:"primary"}},[t._v("关注")])],1),a("div",{staticClass:"conent",domProps:{innerHTML:t._s(t.newsDetail.content)}},[t._v("内容")])]),a("van-field",{attrs:{center:"",clearable:"",placeholder:"请输入评论内容"},scopedSlots:t._u([{key:"button",fn:function(){return[a("van-button",{staticStyle:{"background-color":"#1989fa"},attrs:{size:"small",type:"primary"},on:{click:t.postcontent}},[t._v("发布")])]},proxy:!0}]),model:{value:t.contenttext,callback:function(e){t.contenttext=e},expression:"contenttext"}}),a("van-divider",[t._v("end")]),a("div",{staticClass:"buttom"},[a("van-button",{attrs:{icon:"good-job-o",round:"",plain:"",type:"primary"}},[t._v("点赞")]),a("van-button",{attrs:{color:"red",icon:"delete-o",round:"",plain:"",type:"primary"}},[t._v("不喜欢")])],1),a("ArticleComments",{attrs:{newcomment:t.newcomment}}),a("div",{staticClass:"null"})],1)},Xt=[],te=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了"},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.load,(function(e,n){return a("div",{key:n,staticClass:"load"},[a("van-image",{attrs:{fit:"cover",round:"",src:e.aut_photo}}),a("div",{staticClass:"content"},[a("div",{staticClass:"name"},[t._v(t._s(e.aut_name))]),a("div",{staticClass:"text"},[t._v(t._s(e.content))]),a("div",{staticClass:"time"},[a("span",[t._v(t._s(t._f("dateFormat")(e.pubdate)))]),a("van-button",{attrs:{type:"default",size:"mini"},on:{click:function(a){return t.onrepshow(e)}}},[t._v("回复("+t._s(e.reply_count)+") ")])],1)]),a("van-icon",{attrs:{name:"like-o"}})],1)})),0),a("ArticleRep",{attrs:{repshow:t.repshow,resdata:t.repdata},on:{changereply_count:function(e){t.load.forEach((function(t){t.com_id===e&&t.reply_count++}))},changerepshow:function(e){t.repshow=e}}})],1)},ee=[],ae=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("van-action-sheet",{attrs:{title:"回复"},on:{open:t.close},model:{value:t.toshow,callback:function(e){t.toshow=e},expression:"toshow"}},[a("div",{staticClass:"load"},[a("van-image",{attrs:{fit:"cover",round:"",src:t.data.aut_photo}}),a("div",{staticClass:"content"},[a("p",{staticClass:"name"},[t._v(t._s(t.data.aut_name))]),a("p",{staticClass:"text"},[t._v(t._s(t.data.content))]),a("p",{staticClass:"time"},[t._v(t._s(t._f("dateFormat")(t.data.pubdate)))])])],1),a("van-divider",[t._v("回复列表")]),a("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了"},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.resbackdata,(function(e){return a("div",{key:e.com_id,staticClass:"load"},[a("van-image",{attrs:{fit:"cover",round:"",src:e.aut_photo}}),a("div",{staticClass:"content"},[a("p",{staticClass:"name"},[t._v(t._s(e.aut_name))]),a("p",{staticClass:"text"},[t._v(t._s(e.content))]),a("p",{staticClass:"time"},[t._v(t._s(t._f("dateFormat")(e.pubdate)))])])],1)})),0),a("van-field",{attrs:{center:"",clearable:"",placeholder:"请输入评论内容"},scopedSlots:t._u([{key:"button",fn:function(){return[a("van-button",{staticStyle:{"background-color":"#1989fa"},attrs:{size:"small",type:"primary"},on:{click:t.backpostcontent}},[t._v("发布")])]},proxy:!0}]),model:{value:t.backcontenttext,callback:function(e){t.backcontenttext=e},expression:"backcontenttext"}})],1)],1)},ne=[],se={props:["repshow","resdata"],watch:{repshow(t){this.toshow=t,t||(this.resbackdata=[])},toshow(t){this.$emit("changerepshow",t)},resdata(t){this.data=t}},data(){return{data:"",toshow:!1,loading:!1,finished:!1,offset:null,backcontenttext:"",resbackdata:[]}},methods:{async onLoad(){const t=await J({type:"c",source:this.data.com_id,offset:this.offset});this.resbackdata=t.data.data.results,t.data.data.end_id===t.data.data.last_id&&(this.finished=!0),this.loading=!1},close(){this.finished=!1},async backpostcontent(){if(!this.backcontenttext)return this.$toast.fail("内容为空");const t=await Y({target:this.data.com_id,content:this.backcontenttext,art_id:this.$route.query.id});this.resbackdata.unshift(t.data.data.new_obj),this.$emit("changereply_count",this.data.com_id),this.backcontenttext="",this.$toast.success("发布成功")}}},oe=se,ie=(0,l.Z)(oe,ae,ne,!1,null,"a78b0850",null),re=ie.exports,le={props:["newcomment"],components:{ArticleRep:re},watch:{newcomment(t,e){this.load.unshift(t)}},data(){return{list:[],loading:!1,finished:!1,load:[],offset:null,repshow:!1,repdata:"",resbackdata:[]}},methods:{async onLoad(){const t=await J({type:"a",source:this.$route.query.id,offset:this.offset});this.load.push(...t.data.data.results),t.data.data.end_id===t.data.data.last_id&&(this.finished=!0),this.loading=!1},onrepshow(t){this.repshow=!0,this.repdata=t}}},ce=le,ue=(0,l.Z)(ce,te,ee,!1,null,"280a8c44",null),he=ue.exports,de={components:{ArticleComments:he},data(){return{newsDetail:{},contenttext:"",newcomment:[]}},async created(){console.log(this.$route.query.id);const t=await B(this.$route.query.id);this.newsDetail=t.data.data},methods:{async postcontent(){if(!this.contenttext)return this.$toast.fail("内容为空");const t=await Y({target:this.$route.query.id,content:this.contenttext});console.log(t),this.newcomment=t.data.data.new_obj,this.contenttext="",this.$toast.success("发布成功")}}},me=de,pe=(0,l.Z)(me,Qt,Xt,!1,null,"1fd37510",null),ve=pe.exports,fe=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("van-nav-bar",{attrs:{title:"搜索中心","left-arrow":""},on:{"click-left":function(e){return t.$router.go(-1)}}}),a("form",{attrs:{action:"/"}},[a("van-search",{attrs:{shape:"round","show-action":"",placeholder:"请输入搜索关键词"},on:{search:t.onSearch,input:t.lenovo},scopedSlots:t._u([{key:"action",fn:function(){return[a("div",{on:{click:function(e){return t.onSearch()}}},[t._v("搜索")])]},proxy:!0}]),model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:t.value,expression:"value"}],staticClass:"lenovo"},t._l(this.lenovoResdata,(function(e,n){return a("van-cell",{key:n,attrs:{icon:"search"},on:{click:function(e){return t.onSearch(t.resdata[n])}}},[a("span",{domProps:{innerHTML:t._s(e)}})])})),1),a("div",{directives:[{name:"show",rawName:"v-show",value:t.SeacherHistory&&""==t.value,expression:"SeacherHistory && value == ''"}]},[a("van-cell",{attrs:{title:"历史记录"}}),t._l(this.SeacherHistory,(function(e,n){return a("van-cell",{key:n,on:{click:function(a){return t.onSearch(e)}}},[t._v(" "+t._s(e)+" ")])}))],2)],1)},ge=[],ye={name:"search",data(){return{value:"",lenovoResdata:[],resdata:[],SeacherHistory:JSON.parse(localStorage.getItem("SeacherHistory"))||[]}},methods:{onSearch(t){t?this.$router.push({path:"/search/result",query:{q:t}}):this.$router.push({path:"/search/result",query:{q:this.value}}),this.value&&(this.SeacherHistory.includes(this.value)||this.SeacherHistory.push(this.value),localStorage.setItem("SeacherHistory",JSON.stringify(this.SeacherHistory)))},async lenovo(){if(this.value){const t=await G({q:this.value});this.resdata=t.data.data.options;let e=new RegExp(this.value,"gi");try{const a=t.data.data.options.map((t=>t.replace(e,'<span style="color:red">'+this.value+"</span>")));this.lenovoResdata=a}catch{console.log("error")}}}}},_e=ye,be=(0,l.Z)(_e,fe,ge,!1,null,null,null),ke=be.exports,je=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("van-nav-bar",{attrs:{title:t.$route.query.q+"搜索结果","left-arrow":""},on:{"click-left":function(e){return t.$router.go(-1)}}}),a("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了"},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(this.seachdata,(function(e,n){return a("van-cell",{key:n,on:{click:function(a){return t.todetails(e.art_id)}}},[t._v(" "+t._s(e.title)+" ")])})),1)],1)},we=[],xe={data(){return{value:"",seachdata:[],loading:!1,finished:!1,page:1}},methods:{async onLoad(){try{this.value=this.$route.query.q;const t=await W({q:this.value,page:this.page});this.seachdata.push(...t.data.data.results),this.page++,this.loading=!1,t.data.data.total_count<=this.seachdata.length&&(this.finished=!0)}catch{console.log("无数据")}},todetails(t){this.$router.push({path:"/layout/home/articleDetails",query:{id:t}})}}},Ce=xe,Ze=(0,l.Z)(Ce,je,we,!1,null,null,null),$e=Ze.exports,Se=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("van-nav-bar",{attrs:{fixed:"","left-arrow":"",title:"小智同学"},on:{"click-left":function(e){return t.$router.back()}}}),a("div",{ref:"chatList",staticClass:"chat-list"},[t._l(t.list,(function(e,n){return[e.isMe?a("div",{key:n,staticClass:"chat-item right"},[a("div",{staticClass:"chat-pao my"},[t._v(t._s(e.msg))]),a("van-image",{attrs:{fit:"cover",round:"",src:"https://img.yzcdn.cn/vant/cat.jpeg"}})],1):a("div",{key:n,staticClass:"chat-item left"},[a("van-image",{attrs:{fit:"cover",round:"",src:"https://img.yzcdn.cn/vant/cat.jpeg"}}),a("div",{staticClass:"chat-pao"},[t._v(t._s(e.msg))])],1)]}))],2),a("div",{staticClass:"reply-container van-hairline--top"},[a("van-field",{attrs:{placeholder:"说点什么..."},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.send.apply(null,arguments)}},model:{value:t.msg,callback:function(e){t.msg=e},expression:"msg"}},[a("span",{staticStyle:{"font-size":"12px",color:"#999"},attrs:{slot:"button"},on:{click:t.send},slot:"button"},[t._v(" 提交 ")])])],1)],1)},Oe=[],ze=a(1693),Le={name:"UserChat",data(){return{socket:null,msg:"",list:[]}},created(){this.socket=(0,ze.io)("http://toutiao.itheima.net",{query:{token:this.$store.state.tokenObj.token},transports:["websocket"]}),this.socket.on("message",(t=>{this.list.push({isMe:!1,msg:t.msg}),this.$nextTick((()=>{this.$refs.chatList.scrollTop=this.$refs.chatList.scrollHeight}))}))},methods:{send(){if(""==this.msg)return alert("请输入点什么");this.socket.emit("message",{msg:this.msg,timestamp:Date.now()}),this.list.push({isMe:!0,msg:this.msg}),this.msg="",this.$nextTick((()=>{this.$refs.chatList.scrollTop=this.$refs.chatList.scrollHeight}))}}},qe=Le,De=(0,l.Z)(qe,Se,Oe,!1,null,"29fd9b9b",null),Ee=De.exports;n.Z.use(d.Z);const He=[{path:"/",redirect:"/layout/home"},{path:"/search",name:"search",component:ke},{path:"/search/result",name:"result",component:$e},{path:"/layout/home/articleDetails",name:"articleDetails",component:ve},{name:"edit",path:"/layout/mine/edit",component:Kt,meta:{isLogin:!0}},{name:"chat",path:"/layout/mine/chat",component:Ee,meta:{isLogin:!0}},{name:"login",path:"/login",component:tt},{name:"layout",path:"/layout",component:it,children:[{name:"home",path:"home",component:xt,meta:{iskeep:!0}},{name:"ask",path:"ask",component:zt},{name:"video",path:"video",component:Tt},{name:"mine",path:"mine",component:Vt,meta:{isLogin:!0}}]}],Te=new d.Z({routes:He});Te.beforeEach(((t,e,a)=>{t.meta.isLogin?j.state.tokenObj.token?a():(a({name:"login",query:{back:t.path}}),h.Z.fail("请先登录")):a()}));const Ne=d.Z.prototype.push;d.Z.prototype.push=function(t,e,a){return e||a?Ne.call(this,t,e,a):Ne.call(this,t).catch((t=>t))};var Ie=Te,Me=(a(1821),a(5979),a(9851)),Ue=(a(6283),a(1197)),Pe=(a(8395),a(5263)),Ve=(a(8409),a(9138)),Ae=(a(4112),a(5731)),Re=(a(5758),a(5803)),Fe=(a(6139),a(8235)),Be=(a(2943),a(7735)),Je=(a(9735),a(520)),Ye=(a(7057),a(1911)),Ge=(a(4663),a(338)),We=(a(9497),a(7384)),Ke=(a(7542),a(1404)),Qe=(a(9035),a(9702)),Xe=(a(1031),a(6586)),ta=(a(4138),a(7129)),ea=(a(8114),a(8033)),aa=(a(3257),a(9327)),na=(a(6278),a(7882)),sa=(a(9785),a(8862)),oa=(a(5180),a(3316)),ia=(a(4870),a(4327)),ra=(a(4480),a(3594)),la=(a(8134),a(2084)),ca=(a(2314),a(1802));n.Z.use(ca.Z),n.Z.use(la.Z),n.Z.use(ra.Z),n.Z.use(ia.Z),n.Z.use(oa.Z),n.Z.use(sa.Z),n.Z.use(na.Z),n.Z.use(aa.Z),n.Z.use(ea.Z),n.Z.use(ta.Z),n.Z.use(Xe.Z),n.Z.use(Qe.Z),n.Z.use(Ke.Z),n.Z.use(We.Z),n.Z.use(Ge.Z),n.Z.use(Ye.Z),n.Z.use(Je.Z),n.Z.use(Be.Z),n.Z.use(Fe.Z),n.Z.use(Re.Z),n.Z.use(Ae.Z),n.Z.use(h.Z),n.Z.use(Ve.Z),n.Z.use(Pe.Z),n.Z.use(Ue.Z),n.Z.use(Me.Z),Bt().locale("zh-cn"),n.Z.filter("dateFormat",(function(t){return Bt()(t).fromNow()})),new n.Z({router:Ie,store:j,render:t=>t(u)}).$mount("#app")}},e={};function a(n){var s=e[n];if(void 0!==s)return s.exports;var o=e[n]={id:n,loaded:!1,exports:{}};return t[n].call(o.exports,o,o.exports,a),o.loaded=!0,o.exports}a.m=t,function(){var t=[];a.O=function(e,n,s,o){if(!n){var i=1/0;for(u=0;u<t.length;u++){n=t[u][0],s=t[u][1],o=t[u][2];for(var r=!0,l=0;l<n.length;l++)(!1&o||i>=o)&&Object.keys(a.O).every((function(t){return a.O[t](n[l])}))?n.splice(l--,1):(r=!1,o<i&&(i=o));if(r){t.splice(u--,1);var c=s();void 0!==c&&(e=c)}}return e}o=o||0;for(var u=t.length;u>0&&t[u-1][2]>o;u--)t[u]=t[u-1];t[u]=[n,s,o]}}(),function(){a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,{a:e}),e}}(),function(){a.d=function(t,e){for(var n in e)a.o(e,n)&&!a.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){a.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t}}(),function(){var t={143:0};a.O.j=function(e){return 0===t[e]};var e=function(e,n){var s,o,i=n[0],r=n[1],l=n[2],c=0;if(i.some((function(e){return 0!==t[e]}))){for(s in r)a.o(r,s)&&(a.m[s]=r[s]);if(l)var u=l(a)}for(e&&e(n);c<i.length;c++)o=i[c],a.o(t,o)&&t[o]&&t[o][0](),t[o]=0;return a.O(u)},n=self["webpackChunkheimato"]=self["webpackChunkheimato"]||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))}();var n=a.O(void 0,[998],(function(){return a(4158)}));n=a.O(n)})();